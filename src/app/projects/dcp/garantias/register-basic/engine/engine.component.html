<div class="container">
    <div class="row">
        <div class="col-md-12 margin-b-15">
            <h4 *ngIf="this.action=='new'" class="font-w-700 margin-b-15">Crear registro básico del {{typeWarrantyText}}</h4>
            <h4 *ngIf="this.action=='edit'" class="font-w-700 margin-b-15">Interna de registro Nº122344555</h4>
            <span class="pointer" (click)="onGarantias()">Garantías</span> > <span class="text-red pointer"> {{this.action=='new'?'Crear registro':'Registro de garantía'}}</span>
        </div>
        <div class="col-md-12">
            <mat-card>
                <mat-card-content>
                    <div class="col-md-12 margin-b-15"><h5>Registro básico</h5></div>
                    <form *ngIf="formRegisterEngine" [formGroup]="formRegisterEngine">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">ESN</mat-label>
                                        <input matInput type="text" placeholder="Buscar ESN" formControlName="esn" (ngModelChange)="getEsn()" placeholder="Ingrese el ESN">
                                        <button mat-icon-button matSuffix (click)="getEsn()">
                                            <mat-icon svgIcon="heroicons_outline:search"></mat-icon>
                                        </button>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2 flex-align-center">
                                    <span class="flex-align-center pointer" (click)="onOpenDialogHistoryEsn()">
                                        <mat-icon svgIcon="heroicons_outline:document-text"></mat-icon>
                                        Historial de {{typeWarrantyText=='motor'?'ESN':'GSN'}}
                                    </span>
                                </div>
                                <div class="col-md-3 flex-align-center">
                                    <button mat-raised-button color="primary" (click)="onOpenDialogRegisterEnrollment()">Registrar matrícula</button>
                                </div>
                                <div class="col-md-4"></div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <mat-card class="card-bg-gray">
                                <div class="row">
                                    <div class="col-md-12 margin-b-15">
                                        <span class="font-w-500 font-sz-16">Información de matrícula</span>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Cliente</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="esn.cliente">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Direccion</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="esn.direccion">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Aplicacion del {{typeWarrantyText}}</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="esn.aplicacion">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Modelo del {{typeWarrantyText}}</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="esn.modelo">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">CPL</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="esn.cpl">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">ETO/PTO</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="esn.etoPto">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Fecha inicio de garantía</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="esn.fechaInicio=='-'?'-':esn.fechaInicio | date: 'dd/MM/yyyy' ">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3 flex-align-center">
                                        <mat-checkbox color="primary" [value]="esn.bis" [disabled]="true">BIS</mat-checkbox>
                                    </div>
                                </div>
                            </mat-card>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Orden de servicio</mat-label>
                                        <input matInput type="text" placeholder="Buscar N° OS" formControlName="os" (ngModelChange)="getOs()" placeholder="Ingrese el OS">
                                        <button mat-icon-button matSuffix (click)="getOs()">
                                            <mat-icon svgIcon="heroicons_outline:search"></mat-icon>
                                        </button>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field appearance="fill">
                                        <mat-label for="">BU</mat-label>
                                        <input matInput type="text" placeholder="" [disabled]="true" [value]="os.bu">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3"></div>
                                <div class="col-md-3"></div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <mat-card class="card-bg-gray">
                                <div class="row">
                                    <div class="col-md-12 margin-b-15">
                                        <span class="font-w-500 font-sz-16">Información del SAP</span>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Clase de actividad</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="os.claseActividad">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Fecha de liberacion</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="os.fechaLib=='-'?'-':os.fechaLib | date: 'dd/MM/yyyy' ">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field appearance="fill">
                                            <mat-label for="">Area de servicios</mat-label>
                                            <input matInput [disabled]="true" type="text" placeholder="" [value]="areaDeServicioAsociado">
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                    </div>
                                </div>
                            </mat-card>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Tipo de garantía</mat-label>
                                        <mat-select placeholder="Placeholder" formControlName="tipoGarantia" (ngModelChange)="selectTypeWarranty()" placeholder="Seleccionar">
                                            <mat-option *ngFor="let warrantyType of warrantyTypes" [value]="warrantyType.value">{{warrantyType.name}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-9"></div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.e">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Numero de parte del repuesto</mat-label>
                                        <input matInput type="text" placeholder="Ingresar" formControlName="numParteRepuesto">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.a">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Punto de falla</mat-label>
                                        <input matInput type="text" placeholder="Ingresar" formControlName="puntoFalla">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.i">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Codigo</mat-label>
                                        <input matInput type="text" placeholder="Ingresar" formControlName="codigoAdicional">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.g">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Punto de ejecución</mat-label>
                                        <input matInput type="text" placeholder="Ingresar" formControlName="ejecucionAdicional">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3 flex-xy-center" *ngIf="viewsTypesWarranty.b">
                                    <mat-radio-group aria-label="Select an option" color="primary" formControlName="medida">
                                        <mat-radio-button value="h">H</mat-radio-button>
                                        <mat-radio-button value="km">KM</mat-radio-button>
                                    </mat-radio-group>
                                </div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.c">
                                    <mat-form-field floatLabel="always">
                                        <mat-label>Fecha de falla</mat-label>
                                        <input matInput [matDatepicker]="pickerFechaFalla" formControlName="fechaFalla" placeholder="Seleccione una fecha">
                                        <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
                                        <mat-datepicker-toggle matSuffix [for]="pickerFechaFalla"></mat-datepicker-toggle>
                                        <mat-datepicker #pickerFechaFalla></mat-datepicker>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.f">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">N° de parte del componente</mat-label>
                                        <input matInput type="text" placeholder="Ingresar" formControlName="numParteFallo">
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.d">
                                    <mat-form-field floatLabel="always">
                                        <mat-label>Fecha de inicio de la garantia</mat-label>
                                        <input matInput [matDatepicker]="pickerFechaGarantia" formControlName="fechaInicioGarantia" placeholder="Seleccione una fecha">
                                        <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
                                        <mat-datepicker-toggle matSuffix [for]="pickerFechaGarantia"></mat-datepicker-toggle>
                                        <mat-datepicker #pickerFechaGarantia></mat-datepicker>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3" *ngIf="viewsTypesWarranty.h">
                                    <mat-form-field floatLabel="always">
                                        <mat-label>Fecha de ejecucion</mat-label>
                                        <input matInput [matDatepicker]="pickerFechaEjecucion" formControlName="fechaAdicional" placeholder="Seleccione una fecha">
                                        <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
                                        <mat-datepicker-toggle matSuffix [for]="pickerFechaEjecucion"></mat-datepicker-toggle>
                                        <mat-datepicker #pickerFechaEjecucion></mat-datepicker>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <hr width="100%" color="#E2E8F0">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-12 margin-b-15">
                                    <span class="font-w-500 font-sz-16">Quejas</span>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Queja</mat-label>
                                        <mat-select placeholder="Seleccionar" formControlName="idQueja1" (ngModelChange)="mostrarQueja(2)">
                                            <mat-option *ngFor="let item of complaints" [value]="item.id">{{item.descripcion}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always" *ngIf="verQueja2">
                                        <mat-label for="">Queja</mat-label>
                                        <mat-select placeholder="Seleccionar" formControlName="idQueja2" (ngModelChange)="mostrarQueja(3)">
                                            <mat-option *ngFor="let item of complaints" [value]="item.id">{{item.descripcion}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always" *ngIf="verQueja3">
                                        <mat-label for="">Queja</mat-label>
                                        <mat-select placeholder="Seleccionar" formControlName="idQueja3" (ngModelChange)="mostrarQueja(4)">
                                            <mat-option *ngFor="let item of complaints" [value]="item.id">{{item.descripcion}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always" *ngIf="verQueja4">
                                        <mat-label for="">Queja</mat-label>
                                        <mat-select placeholder="Seleccionar" formControlName="idQueja4">
                                            <mat-option *ngFor="let item of complaints" [value]="item.id">{{item.descripcion}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field floatLabel="always">
                                        <mat-label for="">Usuario Evaluador</mat-label>
                                        <mat-select placeholder="Seleccionar" formControlName="idUsuarioEvaluador">
                                            <mat-option *ngFor="let user of users" [value]="user.value">{{user.name}}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <mat-form-field floatLabel="always">
                                        <mat-label>Comentarios</mat-label>
                                        <textarea matInput placeholder="Ingrese sus comentarios" formControlName="comentarios"></textarea>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-6"></div>
                            </div>
                        </div>
                    </form>
                </mat-card-content>
                <mat-card-actions align="end" style="margin-bottom: 20px;">
                    <button mat-raised-button *ngIf="this.action=='edit'" (click)="onSendRegister('edit')">Guardar</button>
                    <button mat-raised-button *ngIf="this.action=='edit'" (click)="onSendRegister('rechazar')">Rechazar</button>
                    <button mat-raised-button *ngIf="this.action=='edit'" (click)="onSendRegister('observar')">Observar</button>
                    <button mat-raised-button *ngIf="this.action=='edit'" color="primary" (click)="onSendRegister('naranja')">Transformar</button>
                    <button mat-raised-button *ngIf="this.action=='new'" (click)="onSendRegister('borrador')">Guardar borrador</button>
                    <button mat-raised-button *ngIf="this.action=='new'" color="primary" (click)="onSendRegister('blanca')">Enviar registro</button>                    
                </mat-card-actions>
            </mat-card>
        </div>
    </div>
</div>